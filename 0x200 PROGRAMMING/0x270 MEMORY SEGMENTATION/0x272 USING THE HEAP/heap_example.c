#include <stdio.h>
#include <stdlib.h>
#include <string.h>

int main(int argc , char *argv[])
{
    char *char_ptr;
    int *int_ptr;
    int mem_size;
    
    if( argc < 2 )
        mem_size = 50;
    else
        mem_size = atoi(argv[1]);
    
    printf("\t[+] Allocating %d bytes of memory on the heap for 'char_ptr'\n ",mem_size);
    char_ptr = (char *) malloc(mem_size);
    if ( char_ptr == NULL ){
        fprintf(stderr,"[-] ERROR : Couldn't allocate memory on heap!\n");
        exit(-1);
    }
    
    strcpy(char_ptr,"This memory is for the char_pointer in heap\n");
    printf("char ptr(%p) --------> %s\n",char_ptr,char_ptr);
    
    printf("\t[+] Allocating 12 bytes of memory on the heap for 'int_ptr'\n ",mem_size);
    int_ptr = (int *) malloc(12);
    if ( int_ptr == NULL ){
        fprintf(stderr,"[-] ERROR : Couldn't allocate memory on heap!\n");
        exit(-1);
    }
    
    *int_ptr = 31337;
    printf("int ptr(%p) --------> %d\n",int_ptr,*int_ptr);
    
    printf("\t[-] Freeing Memory of char_ptr...\n");
    free(char_ptr);
    
    printf("\t[+] Allocating another 15 bytes of memory on the heap for 'char_ptr'\n ",mem_size);
    char_ptr = (char *) malloc(15);
    if ( char_ptr == NULL ){
        fprintf(stderr,"[-] ERROR : Couldn't allocate memory on heap!\n");
        exit(-1);
    }
    
    strcpy(char_ptr,"New Memory");
    printf("char ptr(%p) --------> %s\n",char_ptr,char_ptr);
    
    printf("\t[-] Freeing int_ptr's heap...\n");
    free(int_ptr);
    printf("\t[-] Freeing char_ptr's heap...\n");
    free(char_ptr);
    printf("\t\t:) END OF PROGRAM.\n");
}
